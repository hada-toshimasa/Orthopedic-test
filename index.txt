<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>整形外科的テスト法 完全攻略マスター（上級編）</title>
<style>
    body { font-family: "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; background-color: #fdf2e9; margin: 0; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); position: relative; }
    h1 { text-align: center; color: #d35400; margin-bottom: 25px; font-size: 1.8em; border-bottom: 2px solid #eee; padding-bottom: 15px; }
    .reset-btn { position: absolute; top: 20px; right: 20px; background: #95a5a6; color: #fff; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85em; transition: 0.3s; }
    .reset-btn:hover { background: #7f8c8d; }
    .status-bar { background: #fae5d3; padding: 12px 20px; border-radius: 8px; display: flex; justify-content: space-between; color: #a04000; font-weight: bold; margin-bottom: 25px; }
    .question-box { background: #fff5ec; border-left: 6px solid #d35400; padding: 20px; margin-bottom: 25px; font-size: 1.15em; font-weight: bold; line-height: 1.5; }
    .option-btn { display: block; width: 100%; padding: 15px; margin-bottom: 12px; background: #fff; border: 2px solid #e0e0e0; border-radius: 8px; text-align: left; cursor: pointer; transition: all 0.2s; font-size: 1em; color: #444; }
    .option-btn:hover { background-color: #fef5e7; border-color: #d35400; }
    .option-btn.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
    .option-btn.incorrect { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
    .feedback { display: none; margin-top: 20px; padding: 20px; border-radius: 8px; background: #f1f8e9; border: 1px solid #c8e6c9; color: #2e7d32; animation: fadeIn 0.3s; }
    .feedback.error { background: #fdecea; border: 1px solid #fadbd8; color: #7b241c; }
    .source-ref { display: block; margin-top: 8px; font-size: 0.85em; color: #666; text-align: right; font-style: italic; }
    .next-btn { display: block; width: 100%; padding: 18px; background: #d35400; color: #fff; border: none; border-radius: 8px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 25px; opacity: 0.6; pointer-events: none; transition: 0.3s; }
    .next-btn.active { opacity: 1; pointer-events: auto; }
    .next-btn:hover { background-color: #a04000; }
    #result-screen { display: none; text-align: center; padding: 20px; }
    .score-circle { width: 150px; height: 150px; background: #d35400; color: #fff; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 30px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    .score-num { font-size: 3.5em; font-weight: bold; line-height: 1; }
    .score-label { font-size: 0.9em; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="container">
    <div id="start-screen" style="text-align: center; padding: 40px 0;">
        <h1 style="border: none;">整形外科的テスト法<br>完全攻略マスター（上級編）</h1>
        <p style="font-size: 1.1em; margin-bottom: 30px;">全150問のプールから<br>毎回ランダムに20問出題されます。</p>
        <p style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 40px;">合格ライン: 80%以上</p>
        <button class="next-btn active" onclick="startQuiz()">試験を開始する</button>
    </div>

    <div id="quiz-screen" style="display: none;">
        <button class="reset-btn" onclick="resetQuiz()">最初に戻る</button>
        <h1>テスト法クイズ</h1>
        <div class="status-bar">
            <span id="progress">問 1 / 20</span>
            <span id="score">正解数: 0</span>
        </div>
        <div id="question" class="question-box"></div>
        <div id="options"></div>
        <div id="feedback" class="feedback"></div>
        <button id="next-btn" class="next-btn" onclick="nextQuestion()">次の問題へ</button>
    </div>

    <div id="result-screen">
        <h2>試験終了</h2>
        <div class="score-circle">
            <span class="score-num" id="final-score">0</span>
            <span class="score-label">点 / 20点</span>
        </div>
        <p id="result-comment" style="font-size: 1.2em; margin: 20px 0;"></p>
        <button class="next-btn active" onclick="resetQuiz(true)">もう一度挑戦する</button>
    </div>
</div>

<script>
// --- 問題プール Part 1 (1-75: 頚部・胸郭出口・上肢) ---
const poolPart1 = [
    // 頚椎・神経根
    {q:"スパーリングテストにおいて、陽性反応が出るメカニズムとして正しいのは？",o:["椎間板内圧の上昇による髄核脱出","椎間孔の狭小化による神経根圧迫","脊髄後索の圧迫による深部感覚障害","椎骨動脈の血流不全による虚血"],c:1,r:"患側への側屈・伸展・圧迫により椎間孔を物理的に狭め、神経根症状を誘発します。",s:"2ページ"},
    {q:"スパーリングテストとジャクソンテストの使い分けについて、適切な判断は？",o:["側屈痛が強くスパーリングが困難な場合にジャクソンを選択する","ジャクソンはヘルニア専用、スパーリングは狭窄症専用である","常にジャクソンを第一選択とし、陰性ならスパーリングを行う","両テストに臨床的な意義の差はなく、どちらでも良い"],c:0,r:"スパーリングは再現性が高いですが、側屈時の頚部痛が強い場合はジャクソンで代用します。",s:"3ページ"},
    {q:"「10秒テスト（グー・パー）」で陽性（20回以下・拙劣）となる病態の背景にあるのは？",o:["正中神経麻痺による母指対立筋の機能不全","尺骨神経麻痺による骨間筋の萎縮","脊髄圧迫による錐体路症状（巧緻運動障害）","橈骨神経麻痺による手関節下垂"],c:2,r:"脊髄症（ミエロパチー）では、脳からの高速信号伝達が障害され、素早い反復動作が拙劣になります（Clumsy Hand）。",s:"4ページ"},
    {q:"ホフマン反射が陽性（母指屈曲反応）となる場合の神経学的解釈は？",o:["末梢神経（正中神経）の絞扼障害","上位運動ニューロン障害（脊髄の抑制解除）","自律神経系の過剰興奮状態","錐体外路症状（パーキンソン病等）"],c:1,r:"脊髄圧迫により脳からの抑制（ブレーキ）が外れ、反射が亢進した状態（病的反射）を示唆します。",s:"5ページ"},
    {q:"頚椎症性脊髄症（CSM）のスクリーニングとして最も感度が高いテストの組み合わせは？",o:["スパーリングテストとジャクソンテスト","10秒テストとホフマン反射","アドソンテストとライトテスト","SLRテストとブラガードテスト"],c:1,r:"手指の巧緻運動障害（10秒テスト）と病的反射（ホフマン）の組み合わせは脊髄症の検出に有用です。",s:"4-5ページ"},

    // 胸郭出口症候群(TOS)
    {q:"アドソンテストで橈骨動脈の拍動が消失する解剖学的理由は？",o:["小胸筋の短縮により腋窩動脈が圧迫されるため","斜角筋の収縮により斜角筋隙が狭まり、鎖骨下動脈が圧迫されるため","鎖骨と第1肋骨の間隔が狭くなり、神経血管束が挟まれるため","頚肋が存在し、腕神経叢を引き伸ばすため"],c:1,r:"頚部伸展・深呼吸により前・中斜角筋が緊張し、その間の血管を絞扼します。",s:"6ページ"},
    {q:"ライトテスト（Wright test）が陽性となる場合にターゲットとなる筋は？",o:["前斜角筋","中斜角筋","小胸筋","鎖骨下筋"],c:2,r:"肩外転・外旋位で小胸筋が伸張・緊張し、その下を通る神経血管束を圧迫します（過外転症候群）。",s:"9ページ"},
    {q:"エデンテスト（Eden test）で再現しようとしている病態（圧迫部位）は？",o:["斜角筋隙（前斜角筋と中斜角筋の間）","肋鎖間隙（鎖骨と第1肋骨の間）","小胸筋下間隙（烏口突起の下）","四辺形間隙（QLS）"],c:1,r:"胸を張り肩を下制することで鎖骨と第1肋骨の間を狭め、肋鎖症候群を誘発します。",s:"10ページ"},
    {q:"ルーステスト（Roos test）がTOSのスクリーニングとして第一選択になる理由は？",o:["短時間で終わり、患者の負担が少ないから","血管だけでなく神経症状も含めた虚血・絞扼症状を全体的に誘発できるから","特定の筋肉のみを選択的に評価できるから","座位で行える唯一のテストだから"],c:1,r:"挙上位置での反復運動により、血流障害と神経絞扼の両方を負荷をかけて再現できるためです。",s:"8ページ"},
    {q:"モーリーテスト（Morley test）で圧迫する部位と、陽性所見の特徴は？",o:["鎖骨下窩を圧迫し、手の痺れが出る","鎖骨上窩（斜角筋三角）を圧迫し、圧痛に加えて上肢への放散痛が出る","腋窩を圧迫し、動脈拍動が消える","乳様突起下を圧迫し、めまいが出る"],c:1,r:"単なる圧痛だけでなく、末梢への放散痛（Tinel様サイン）が出ることが神経過敏性の証明となります。",s:"7ページ"},
    {q:"胸郭出口症候群のテスト法で「3分間」の持続動作を求めるものは？",o:["ライトテスト","アドソンテスト","ルーステスト","エデンテスト"],c:2,r:"ルーステスト（3分間挙上負荷試験）は、持久力と循環不全を評価するため時間を要します。",s:"8ページ"},

    // 肩関節
    {q:"QLS（四辺形間隙）症候群の診断において、圧痛を確認すべき正確な位置は？",o:["肩峰の前端から2横指下方","肩甲棘の内端","肩峰の後角から3〜4横指下方の小円筋・大円筋間","烏口突起の直下"],c:2,r:"小円筋、大円筋、上腕三頭筋長頭、上腕骨で囲まれた領域（QLS）を後方から触診します。",s:"11ページ"},
    {q:"QLS症候群の「抵抗下外旋テスト」で腋窩神経絞扼が増強する理由は？",o:["上腕三頭筋が収縮してスペースを広げるから","小円筋（上壁）が収縮・膨隆し、スペースを狭めて神経を圧迫するから","大円筋が弛緩して神経が滑走するから","関節包が伸張されるから"],c:1,r:"外旋により小円筋が収縮して太くなり、QLSのトンネルを上から押し潰す形になります。",s:"12ページ"},
    {q:"肩関節拘縮（凍結肩）と腱板断裂を鑑別する際の徒手検査上の決定的な違いは？",o:["夜間痛の有無（凍結肩のみ夜間痛がある）","他動運動（Passive）での可動域制限の有無","筋力低下の有無（凍結肩の方が筋力が落ちる）","レントゲン所見の有無"],c:1,r:"凍結肩は他動でも動かない（拘縮）のに対し、腱板断裂は他動なら動く（拘縮がない限り）ことが多いです。",s:"一般知識"},
    {q:"インピンジメント徴候を確認する「Neerテスト」の操作方法は？",o:["肩甲骨を固定し、上肢を内旋位で前方挙上させる","上肢を外旋位で外転させる","肘を90度曲げて回旋させる","手を背中に回させる"],c:0,r:"肩甲骨を固定して内旋位挙上することで、大結節を肩峰前縁に衝突させます（※マニュアル外だが関連知識）。",s:"一般知識"},
    
    // 肘関節
    {q:"肘内側上顆炎（ゴルフ肘）に対する「手関節屈曲テスト」で陽性となるメカニズムは？",o:["尺骨神経が伸張されるため","手関節屈筋群の強力な収縮により、起始部（内側上顆）に牽引ストレスがかかるため","内側側副靭帯が断裂するため","回内筋が圧迫されるため"],c:1,r:"抵抗下の屈曲で屈筋群が収縮し、付着部である内側上顆の骨膜・腱を強く引っ張ることで痛みます。",s:"13ページ"},
    {q:"肘外側上顆炎（テニス肘）の「トムゼンテスト」で抵抗を加える動作は？",o:["手関節の掌屈","手関節の背屈","前腕の回内","肘の伸展"],c:1,r:"手首を背屈させる短橈側手根伸筋（ECRB）に負荷をかけ、外側上顆への牽引痛を誘発します。",s:"14ページ"},
    {q:"肘外側上顆炎のテストで、特に「短橈側手根伸筋（ECRB）」を選択的に評価できるのは？",o:["トムゼンテスト（手関節背屈）","チェアテスト（椅子持ち上げ）","中指伸展テスト","コーゼンテスト"],c:2,r:"中指の伸展はECRBが主動作筋であるため、より選択的に障害部位にストレスをかけられます。",s:"15ページ"},
    {q:"肘部管症候群（尺骨神経麻痺）を疑う際に確認すべき「チネル徴候」の叩打部位は？",o:["肘頭の頂点","上腕骨内側上顆の後方（尺骨神経溝）","上腕骨外側上顆の前方","手根管部"],c:1,r:"内側上顆の後ろにある尺骨神経溝を叩き、小指側への放散痛を確認します。",s:"一般知識"},
    {q:"テニス肘の病態として、炎症が起きている主な組織は？",o:["長橈側手根伸筋の筋腹","短橈側手根伸筋の起始部（腱付着部）","総指伸筋の停止部","腕橈骨筋の筋膜"],c:1,r:"外側上顆に付着する短橈側手根伸筋（ECRB）の起始部変性・微細断裂が主病態です。",s:"14-15ページ"},

    // 手・指
    {q:"手根管症候群の「ファーレンテスト」で陽性反応が出るまでの時間の目安は？",o:["10秒以内なら重度、1分以内なら陽性","3分間持続して初めて陽性","瞬時に出なければ陰性","5分以上かかる"],c:0,r:"通常は1分間の保持で評価しますが、重症例ではたった数秒で強烈なしびれが出現します。",s:"16ページ"},
    {q:"手根管症候群の病態生理として、ファーレンテストが症状を誘発する理由は？",o:["神経を伸張しているから","手関節屈曲により手根管内圧が上昇し、正中神経の虚血・圧迫が増強するから","動脈を遮断しているから","腱が摩擦を起こすから"],c:1,r:"手首を深く曲げると手根管の断面積が減少し内圧が上がるため、神経圧迫が強まります。",s:"16ページ"},
    {q:"ド・ケルバン病（狭窄性腱鞘炎）の「フィンケルシュタインテスト」で伸張される腱は？",o:["長母指屈筋腱と短母指屈筋腱","長母指外転筋腱と短母指伸筋腱","長母指伸筋腱と短母指外転筋腱","総指伸筋腱"],c:1,r:"第1区画を通る長母指外転筋腱と短母指伸筋腱が、尺屈により強く引き伸ばされます。",s:"17ページ"},
    {q:"フィンケルシュタインテストを行う際、患者に指示する親指の位置は？",o:["親指を外に出して握る","親指を中に入れて握り込む","親指を立てる","親指を反らす"],c:1,r:"親指を中に入れて握り込むことで、尺屈時に腱への伸張ストレスが最大化されます。",s:"17ページ"},
    {q:"バネ指（弾発指）の触診で、圧痛や硬結、弾発現象を確認すべき部位は？",o:["DIP関節（第一関節）","PIP関節（第二関節）","MP関節（指の付け根）の掌側","手首の掌側"],c:2,r:"A1プーリーが存在するMP関節掌側で、腱の肥厚による引っかかりが生じます。",s:"18ページ"},
    {q:"母指CM関節症を疑う際の「グラインドテスト」の操作方法は？",o:["母指を牽引する","母指を中に入れて手首を曲げる","母指中手骨を大菱形骨に押し付けながら回旋させる","母指を反らす"],c:2,r:"関節面同士を圧迫・回旋させ、軟骨摩耗による疼痛や轢音を誘発します（※一般知識）。",s:"一般知識"},
    
    // 腰椎（ヘルニア）
    {q:"SLRテストにおいて、坐骨神経に十分な張力が加わり始める角度は？",o:["0〜15度","15〜30度","35〜70度","70度以上"],c:2,r:"35度〜70度の範囲で神経根が最も移動・伸張されるため、この範囲での疼痛が診断的価値を持ちます。",s:"19ページ"},
    {q:"SLRテストが陽性（70度以下で疼痛）の場合、鑑別すべき「ハムストリングスの短縮」との違いは？",o:["痛みの部位（大腿後面のみか、下腿まで放散するか）","膝が曲がるかどうか","左右差があるかどうか","足首が硬いかどうか"],c:0,r:"膝裏や太もものツッパリ感だけでなく、膝を超えて下腿・足部まで走る痛みが神経根症状の特徴です。",s:"19ページ"},
    {q:"ブラガードテストの意義として、SLRテストに加えて足関節を背屈させる理由は？",o:["アキレス腱の反射を見るため","脛骨神経を介して坐骨神経を末梢側からさらに牽引し、神経由来の疼痛であることを確定するため","腓腹筋の肉離れを確認するため","足底筋膜を伸ばすため"],c:1,r:"神経の連続性を利用し、末梢からの牽引を加えることで、筋性疼痛との鑑別をより確実にします。",s:"20ページ"},
    {q:"ケンプテストで「患側への放散痛」が出現した場合に示唆される病態は？",o:["椎間板内圧の上昇によるヘルニアの脱出","椎間孔の狭小化による神経根の挟み込み（狭窄症や外側ヘルニア）","脊柱起立筋の筋スパズム","仙腸関節の離開"],c:1,r:"伸展・回旋・側屈により椎間孔が最も狭くなるため、そこでの物理的な神経圧迫を再現しています。",s:"21ページ"},
    {q:"ケンプテストで「健側（倒した反対側）」に痛みが出た場合、最も考えられる原因は？",o:["神経根圧迫","筋・筋膜の伸張痛","椎間関節の衝突","椎体骨折"],c:1,r:"神経根症状は通常同側に出ます。反対側の痛みは、引き伸ばされた筋肉や筋膜の痛みの可能性が高いです。",s:"21ページ"},
    {q:"腰椎椎間板ヘルニアにおける「ラセーグ徴候」と「SLRテスト」の違いは？",o:["同じテストの別名である","ラセーグは座位、SLRは仰臥位","ラセーグは膝を曲げる、SLRは伸ばす","ラセーグは股関節、SLRは膝関節を見る"],c:0,r:"厳密には手技に細かな違いがある場合もありますが、臨床的には下肢挙上試験としてほぼ同義で扱われます。",s:"19ページ"},
    {q:"FNS（大腿神経伸張）テストが陽性となるヘルニアの好発部位は？",o:["L4/L5","L5/S1","L2/L3 または L3/L4","Th12/L1"],c:2,r:"FNSは大腿神経（L2-4）を伸張するため、上位腰椎のヘルニア検出に用いられます。",s:"一般知識"},
    {q:"SLRテストで70度以上挙上可能だが、腰痛のみ訴える場合の解釈は？",o:["重度のヘルニア","神経根の癒着","椎間関節性や筋・筋膜性腰痛、または仙腸関節障害の疑い","詐病"],c:2,r:"神経根の強い圧迫や炎症があれば70度まで上がりません。可動域が保たれている場合は機能的腰痛を疑います。",s:"19ページ"},
    {q:"Kempテストが陽性だが、下肢痛がなく「腰の局所痛」のみの場合に疑うべき組織は？",o:["神経根","椎間板","椎間関節（Facets）","靭帯"],c:2,r:"放散痛を伴わない伸展回旋痛は、椎間関節症候群（Facets Syndrome）の典型的な所見です。",s:"21ページ"},
    {q:"バルサルバテスト（怒責）で痛みが再現される生理学的機序は？",o:["腹直筋の収縮","脳脊髄液圧（髄腔内圧）の上昇による神経根への圧刺激","血圧上昇による血管拡張","横隔膜の下降"],c:1,r:"息んで腹圧が上がると硬膜管内の圧力が上がり、ヘルニア等の占拠病変がある神経を圧迫します。",s:"一般知識（※坐骨神経痛マニュアル参照）"},
];
// --- 問題プール Part 2 (76-150: 股・膝・足・鑑別・応用) ---
const poolPart2 = [
    // 股関節
    {q:"変形性股関節症の初期において、最も制限されやすい可動域は？",o:["屈曲","外転","内旋","伸展"],c:2,r:"関節包の線維化や骨頭変形により、初期には内旋可動域の制限（健側比）が著明に現れます。",s:"27ページ"},
    {q:"パトリックテスト（Patrick test）が陽性となる場合に示唆される疾患は？",o:["股関節疾患（変形性股関節症等）または仙腸関節障害","腰椎椎間板ヘルニア","大腿四頭筋拘縮","膝半月板損傷"],c:0,r:"股関節の開排制限・疼痛は股関節病変を、後部痛は仙腸関節障害を示唆します。",s:"26ページ"},
    {q:"トーマステスト（Thomas test）は何を評価するテストか？",o:["股関節の屈曲拘縮（腸腰筋の短縮）","ハムストリングスの短縮","大殿筋の筋力","内転筋の短縮"],c:0,r:"健側股関節を最大屈曲させた際、患側の大腿がベッドから浮けば腸腰筋の短縮（屈曲拘縮）ありと判断します（※マニュアル外だが関連知識）。",s:"一般知識"},
    {q:"トレンデレンブルグ徴候が見られる場合、筋力低下している筋は？",o:["中殿筋","大殿筋","大腿四頭筋","ハムストリングス"],c:0,r:"患側下肢で立った時に、骨盤を水平に保てず健側が下がる現象です（※一般知識）。",s:"一般知識"},

    // 膝関節
    {q:"マックマレーテスト（McMurray test）で「クリック音」や「疼痛」が生じる機序は？",o:["断裂した半月板が関節内で挟み込まれるため","靭帯が伸びるため","骨が擦れるため","筋肉が痙攣するため"],c:0,r:"膝の回旋と圧迫により、半月板の断裂部を大腿骨と脛骨の間に捕捉して症状を誘発します。",s:"29ページ"},
    {q:"パテラグラインドテスト（Patella grind test）で確認できる所見は？",o:["膝蓋骨の脱臼不安感","膝蓋大腿関節（PF関節）の軟骨摩耗による捻髪音（ジャリジャリ音）や疼痛","膝蓋腱の圧痛","側副靭帯の緩み"],c:1,r:"膝蓋骨を大腿骨に押し付けながら動かすことで、軟骨の変性や粗造化を評価します。",s:"28ページ"},
    {q:"腸脛靭帯炎（ランナー膝）を評価する「グラスピングテスト」で、疼痛が誘発される膝屈曲角度は？",o:["0度（完全伸展）","30度付近","90度","120度以上"],c:1,r:"屈曲30度付近で腸脛靭帯が大腿骨外側上顆を乗り越えるため、この角度で摩擦（インピンジメント）が最大化します。",s:"30ページ"},
    {q:"オーバーテスト（Ober test）が陽性（足がベッドまで下りない）の場合、短縮している組織は？",o:["大腿直筋","腸脛靭帯（および大腿筋膜張筋）","ハムストリングス","内転筋群"],c:1,r:"側臥位で股関節を伸展・外転させた位置から、腸脛靭帯の緊張により内転が制限されるかを見ます。",s:"31ページ"},
    {q:"前十字靭帯（ACL）断裂を疑う際に行う徒手検査として最も信頼性が高いのは？",o:["ラックマンテスト","マックマレーテスト","パテラグラインドテスト","アプレーテスト"],c:0,r:"膝屈曲20-30度で行うラックマンテスト（Lachman test）は、ACL損傷の検出感度が最も高いとされています（※一般知識）。",s:"一般知識"},
    {q:"後十字靭帯（PCL）損傷を示唆する「サギング徴候（Sagging sign）」とは？",o:["膝を立てて寝た時に、脛骨粗面が後方に落ち込む現象","膝が過伸展する現象","膝が外反する現象","皿が浮く現象"],c:0,r:"PCLが断裂すると脛骨を支えきれず、重力で脛骨が後方へ沈下します（※一般知識）。",s:"一般知識"},

    // 足関節・足部
    {q:"アキレス腱断裂の「トンプソンテスト」で陽性となる反応は？",o:["ふくらはぎを掴んでも足関節が底屈しない","ふくらはぎを掴むと激痛が走る","足首が背屈する","指が動かない"],c:0,r:"アキレス腱が繋がっていれば腓腹筋の圧迫で足首が底屈しますが、断裂すると力が伝わらず動きません。",s:"32ページ"},
    {q:"足底筋膜炎の圧痛点として最も特徴的な部位は？",o:["踵骨内側結節（足底腱膜起始部）","足の甲","アキレス腱付着部","中足骨頭"],c:0,r:"着地時の衝撃と腱膜の牽引力が集中する踵骨内側結節に、鋭い圧痛が見られます。",s:"33ページ"},
    {q:"モートン病を疑う「マルダーサイン（Mulder's sign）」の操作方法は？",o:["足趾を背屈させる","中足骨頭部を左右から挟み込み（横アーチ圧迫）、足底から突き上げる","踵を叩く","足首を回す"],c:1,r:"中足骨の間隔を狭めることで、肥大した神経腫が弾かれるクリック音（Mulder click）や放散痛を誘発します。",s:"34ページ"},
    {q:"足関節の前距腓靭帯（ATFL）損傷を評価するテストは？",o:["前方引き出しテスト（Anterior Drawer Test）","トンプソンテスト","スクイーズテスト","ヒールレイズ"],c:0,r:"足関節を底屈位にして距骨を前方へ引き出し、緩み（動揺性）を確認します（※一般知識）。",s:"一般知識"},

    // 仙腸関節・体幹
    {q:"仙腸関節障害の「ニュートンテスト」で仙腸関節に加わるストレスの種類は？",o:["圧迫ストレス","剪断（せんだん）ストレス","牽引ストレス","回旋ストレス"],c:1,r:"片足を垂らし（伸展）、反対足を抱える（屈曲）ことで、左右の寛骨に逆方向の回転力がかかり、仙腸関節を剪断します。",s:"22ページ"},
    {q:"ヒブステスト（Hibb's test）で股関節を内旋させることにより、仙腸関節はどうなるか？",o:["前方が離開する","後部が離開（gapping）し、後仙腸靭帯に伸張ストレスがかかる","圧迫されて安定する","動かない"],c:1,r:"大腿骨頭が寛骨臼を外へ押し出すテコの原理で、仙腸関節の後方が開き、靭帯性の疼痛を誘発します。",s:"23ページ"},
    {q:"肋間神経痛の「シェペルマンテスト」で、痛む側による鑑別診断は？",o:["凹側（倒した側）が痛めば神経痛、凸側（伸ばした側）なら筋痛・湿性胸膜炎","どちらも神経痛","凹側が筋肉痛","関係ない"],c:0,r:"凹側は肋間が狭まり神経を圧迫、凸側は組織が伸張されるため、痛む側で原因（神経か筋肉か）を区別します。",s:"24ページ"},
    {q:"肋間神経痛の特徴的な圧痛点（ヴァレー圧痛点）の場所に含まれないのは？",o:["脊柱の際（後枝）","腋窩線（外側皮枝）","胸骨の際（前皮枝）","鎖骨の下"],c:3,r:"肋間神経の皮枝が体表に出てくる「脊柱傍部・腋窩部・胸骨傍部」の3点が圧痛点となります。",s:"25ページ"},

    // 総合・鑑別・応用
    {q:"頚部痛と上肢の痺れがある患者。スパーリング陽性、10秒テスト陰性、ホフマン陰性。最も疑われる病態は？",o:["頚椎症性脊髄症（CSM）","頚椎症性神経根症（Radiculopathy）","脳梗塞","胸郭出口症候群"],c:1,r:"神経根誘発テストが陽性で、脊髄徴候（巧緻運動障害・病的反射）が陰性であることから、神経根症の可能性が高いです。",s:"2-5ページ"},
    {q:"肩の痛みがあるが、他動での可動域制限はなく、ペインフルアークサイン（挙上途中の痛み）がある。疑うべきは？",o:["凍結肩（五十肩）","腱板損傷・インピンジメント","変形性肩関節症","頚椎ヘルニア"],c:1,r:"拘縮がないため凍結肩は否定的。特定の角度での疼痛（有痛弧）は腱板や滑液包のインピンジメントを示唆します。",s:"一般知識"},
    {q:"手根管症候群と円回内筋症候群（前骨間神経麻痺含む）の鑑別点として、手根管症候群には無い症状は？",o:["夜間痛","母指球筋の萎縮","手掌（掌側）の感覚障害","ファーレンテスト陽性"],c:2,r:"正中神経の手掌皮枝は手根管の手前で分岐するため、手根管症候群では手掌の感覚は保たれます（指先は痺れる）。",s:"一般知識"},
    {q:"SLRテスト陰性だが、ニュートンテストとパトリックテストで同側の殿部痛が再現された。疑うべきは？",o:["腰椎ヘルニア","仙腸関節障害","股関節症","ハムストリングス肉離れ"],c:1,r:"神経根症状がなく、仙腸関節ストレステストで陽性となることから、仙腸関節由来の疼痛（AKA等で改善するタイプ）を疑います。",s:"22,26ページ"},
    {q:"膝のロッキング（急に伸びなくなる）症状が見られる場合に疑うべき損傷は？",o:["半月板損傷（バケツ柄断裂）","側副靭帯損傷","膝蓋骨脱臼","オスグッド病"],c:0,r:"断裂した半月板が関節の間に挟まり、機械的に動きをロックしてしまう現象です。",s:"29ページ"},
    {q:"ド・ケルバン病と変形性母指CM関節症の鑑別において、CM関節症の特徴的な所見は？",o:["フィンケルシュタインテスト陽性","CM関節（手首の付け根）の圧痛と変形、グラインドテスト陽性","橈骨茎状突起の腫脹","小指側の痺れ"],c:1,r:"腱鞘炎（ド・ケルバン）は腱の痛みですが、CM関節症は関節自体の変形や圧痛、軸圧痛（グラインド）が特徴です。",s:"17ページ"},
    {q:"「足根管症候群」の症状と類似しており、鑑別が必要な腰部疾患は？",o:["L4神経根症","S1神経根症（足底の痺れ）","L1神経根症","脊柱管狭窄症"],c:1,r:"足根管症候群もS1神経根症も「足底の痺れ」を呈するため、ティネル徴候やSLRテストでの鑑別が必要です。",s:"一般知識"},
    {q:"テニス肘（外側上顆炎）の患者に対し、日常生活で避けるよう指導すべき動作は？",o:["手のひらを上にして物を持つ","手のひらを下にして重い物を持ち上げる（回内位でのリスト伸展）","肘を曲げて顔を洗う","握手をすること"],c:1,r:"回内位で手首を背屈させると短橈側手根伸筋に最大の負荷がかかるため、疼痛を悪化させます。",s:"14-15ページ"},
    {q:"10秒テストで「25回」できたが、動きがぎこちない。判定は？",o:["陰性（正常）","陽性（巧緻運動障害あり）","保留","筋力低下"],c:1,r:"回数がクリアできていても、動作が拙劣（スムーズでない、指が揃わない等）であれば陽性と判断し、脊髄圧迫を疑います。",s:"4ページ"},
    {q:"胸郭出口症候群のテストが全て陰性だが、腕の痺れを訴える。次にチェックすべきポイントは？",o:["頚椎（スパーリング等）や肘・手首（末梢神経絞扼）","足首","内臓","視力"],c:0,r:"TOSが否定的なら、より中枢（頚椎ヘルニア等）か、より末梢（肘部管・手根管等）での絞扼を疑い検査を進めます。",s:"一般知識"},
    {q:"アキレス腱断裂を見逃さないために、トンプソンテストと併せて確認すべき視診所見は？",o:["アキレス腱部の陥凹（へこみ）","足の指の変形","皮膚の色","爪の形"],c:0,r:"断裂部が凹んで見える（陥凹）ことが多く、触診でも連続性の欠如を確認できます。",s:"32ページ"},
    {q:"膝蓋骨骨折の簡易検査として、膝伸展挙上（SLR）ができるかどうかを見る理由は？",o:["痛みを評価するため","大腿四頭筋・膝蓋骨・膝蓋腱による「伸展機構（Extensor Mechanism）」が破綻していないか見るため","股関節を見るため","神経麻痺を見るため"],c:1,r:"膝蓋骨が割れて伸展機構が破綻すると、膝を伸ばしたまま脚を持ち上げることができなくなります（※一般知識）。",s:"一般知識"},
    {q:"坐骨神経痛の鑑別で、K.ボンネットテストが陽性だった場合の治療ターゲット筋は？",o:["梨状筋","大殿筋","ハムストリングス","脊柱起立筋"],c:0,r:"梨状筋による神経絞扼が示唆されるため、梨状筋のリリースやストレッチを行います。",s:"一般知識（※坐骨神経痛マニュアル参照）"},
    {q:"整形外科的テスト法を行う際の大原則は？",o:["いきなり患側から全力で行う","健側から行い正常な反応を確認した後、患側を愛護的に検査する","痛くても我慢させる","説明せずに不意打ちで行う"],c:1,r:"健側との比較が重要であり、また患者の不安を取り除くためにも健側から行うのが鉄則です。",s:"一般知識"},
    {q:"テスト結果をカルテに記載する際、「＋（プラス）」は何を意味するか？",o:["良好","陽性（所見あり）","陰性（所見なし）","要観察"],c:1,r:"陽性（Positive）を＋、陰性（Negative）を－と記載するのが一般的です。",s:"一般知識"}
];

// --- 2つのプールを結合して使用する ---
const questionPool = poolPart1.concat(poolPart2);

// --- システムロジック ---
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

let currentQuizSet = [];
let currentQuestionIndex = 0;
let score = 0;

const startScreen = document.getElementById('start-screen');
const quizScreen = document.getElementById('quiz-screen');
const resultScreen = document.getElementById('result-screen');
const questionBox = document.getElementById('question');
const optionsBox = document.getElementById('options');
const feedbackBox = document.getElementById('feedback');
const nextBtn = document.getElementById('next-btn');
const progress = document.getElementById('progress');
const scoreDisplay = document.getElementById('score');
const resultComment = document.getElementById('result-comment');

// 1回の出題数
const QUESTIONS_PER_ROUND = 20;

function startQuiz() {
    currentQuizSet = shuffle([...questionPool]).slice(0, QUESTIONS_PER_ROUND);
    currentQuestionIndex = 0;
    score = 0;
    startScreen.style.display = 'none';
    resultScreen.style.display = 'none';
    quizScreen.style.display = 'block';
    showQuestion();
}

function resetQuiz(restart = false) {
    if (restart || confirm("テストを中断して最初の画面に戻りますか？")) {
        startScreen.style.display = 'block';
        quizScreen.style.display = 'none';
        resultScreen.style.display = 'none';
        currentQuestionIndex = 0;
        score = 0;
    }
}

function showQuestion() {
    const q = currentQuizSet[currentQuestionIndex];
    questionBox.textContent = `Q${currentQuestionIndex + 1}. ${q.q}`;
    optionsBox.innerHTML = '';
    feedbackBox.style.display = 'none';
    feedbackBox.className = 'feedback';
    nextBtn.classList.remove('active');
    progress.textContent = `問 ${currentQuestionIndex + 1} / ${QUESTIONS_PER_ROUND}`;
    scoreDisplay.textContent = `正解数: ${score}`;

    q.o.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = option;
        btn.onclick = () => checkAnswer(index, btn, q);
        optionsBox.appendChild(btn);
    });
}

function checkAnswer(selectedIndex, selectedBtn, q) {
    if (nextBtn.classList.contains('active')) return;

    const isCorrect = (selectedIndex === q.c);
    const options = document.querySelectorAll('.option-btn');

    if (isCorrect) {
        selectedBtn.classList.add('correct');
        feedbackBox.innerHTML = `<strong>正解！</strong><br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback';
        score++;
        scoreDisplay.textContent = `正解数: ${score}`;
    } else {
        selectedBtn.classList.add('incorrect');
        options[q.c].classList.add('correct');
        feedbackBox.innerHTML = `<strong>不正解...</strong><br>正解は「${q.o[q.c]}」です。<br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback error';
    }
    feedbackBox.style.display = 'block';
    nextBtn.classList.add('active');
}

function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < QUESTIONS_PER_ROUND) {
        showQuestion();
    } else {
        showResult();
    }
}

function showResult() {
    quizScreen.style.display = 'none';
    resultScreen.style.display = 'block';
    document.getElementById('final-score').textContent = score;
    
    const percentage = (score / QUESTIONS_PER_ROUND) * 100;
    if (percentage >= 80) {
        resultComment.innerHTML = `<span style="color:#27ae60">合格！素晴らしい知識です。</span>`;
    } else if (percentage >= 60) {
        resultComment.innerHTML = `<span style="color:#f39c12">あと一歩！復習しましょう。</span>`;
    } else {
        resultComment.innerHTML = `<span style="color:#c0392b">不合格。マニュアルを読み返して再挑戦！</span>`;
    }
}
</script>
</body>
</html>